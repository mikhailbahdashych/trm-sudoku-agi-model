# TRM for Sudoku-Extreme Configuration
# Based on "Less is More: Recursive Reasoning with Tiny Networks"

# Model Architecture
model:
  hidden_dim: 512
  n_latent: 6
  T_deep: 3
  use_act: true
  mlp_ratio: 2.666667

# Training Configuration
training:
  epochs: 3000
  train_samples: 5000
  augmentations_per_sample: 1000

  batch_size: 20480
  learning_rate: 0.0005
  weight_decay: 1.0
  warmup_steps: 400
  max_grad_norm: 1.0

  early_stopping: true
  early_stopping_patience: 50
  early_stopping_min_delta: 0.0003

  ema_decay: 0.999
  ema_warmup_steps: 40

  use_amp: true
  amp_dtype: float16

# Data
data:
  dataset_name: "Ritvik19/Sudoku-Dataset"
  num_workers: 4
  seed: 42
  test_samples: 2000

# Logging and Checkpointing
logging:
  log_interval: 244
  eval_interval: 488
  save_interval: 1220
  output_dir: outputs

# Evaluation
evaluation:
  test_samples: null
  llm_comparison_samples: 5

# LLM Comparison (Ollama)
llm:
  model: "llama3.2"
  ollama_url: "http://localhost:11434"
  strategies:
    - direct
    - cot
    - fewshot

# Device
device: cuda
